# ipfs-wormhole

Get things from one computer to another, safely. Over IPFS (which is not even
required to receive files thanks to the [Cloudflare IPFS
gateway](https://cloudflare-ipfs.com)).

Inspired by [magic-wormhole](https://github.com/warner/magic-wormhole) and
[dat-cp](https://github.com/tom-james-watson/dat-cp). Initially published
[here](https://www.reddit.com/r/ipfs/comments/9yyqi1/dat_dcpstyle_functionality_for_encrypted_assets/?utm_source=reddit-android).

# Usage

## Send a file or a directory

On machine A:

`ipfs-wormhole.sh send <file or directory>`

Will encrypt and add the file (or the directory as a compressed tarball) to
IPFS, and output a tag. If xclip is installed, the command to retrieve it will
be copied to the clipboard.

## Receive a file or a directory (as a compressed tarball)

On machine B:

`ipfs-wormhole.sh receive <tag>`

Will retrieve the file over IPFS if IPFS is installed and running, or if it's
not, over HTTPS thanks to the [Cloudflare IPFS
gateway](https://cloudflare-ipfs.com), decrypt it and save it locally.

## Check dependencies

`ipfs-wormhole.sh checkdeps`

## Update from the github repo

`ipfs-wormhole.sh update`

## Parameters

The default password length and IPFS gateway can be overidden by setting the
environment variables IWPASSWORDLENGTH and IWIPFSGATEWAY, respectively.

E.g.:

- `IWPASSWORDLENGTH=50 ipfs-wormhole.sh send FILE` will use a longer password to
  encrypt FILE (default length is 40).
- `IWIPFSGATEWAY=https://gateway.ipfs.io/ipfs ipfs-wormhole.sh receive tag` will
  use the official IPFS gateway (instead of Cloudflare's gateway) if `ipfs daemon` is not running.

# How it works

Your data is encrypted on the sender's machine, using `gpg` and its default
symmetric cipher (depending on your configuration), with a temporary random
password generated by `pwgen`.

Once encrypted, your data is made available for others from your machine using
[IPFS](https://ipfs.io).

The temporary password (as well as the base64 encrypted filename, for that
matter) is concatenated to the IPFS hash in a `tag`, which consequently has to
be transmitted over a secure channel to the recipient's machine (e.g. `ssh`).

On the recipient's machine, the encrypted data is retrieved:

- from IPFS if IPFS is runnning
- over HTTPS from the Cloudflare IPFS gateway if IPFS it not running (or not
  installed).

The encrypted data is subsequently decrypted on the recipient's machine with the
password (extracted from the tag), and saved with the proper file name (also
extracted from the tag).

Confidentiality is not an issue as long as you trust `gpg`, its default
symmetric cipher (it's up to you to change it), and `pwgen`.

# FAQ

## Who owns my data once I use ipfs-wormhole?

TL;DR no one except the sender and the recipient. `ipfs-wormhole` is end-to-end
encrypted with `gpg`.

## Where does it store my data?

Your data are provided by the sender's machine and routed to the recipient's
machine over [IPFS](https://ipfs.io).
